<!DOCTYPE html>
<html lang="zh">
	<head>
		<meta charset="utf-8"/>
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		<meta name="generator" content="Hugo 0.68.3" />
		<title>Java生成图片验证码 - 小蜜蜂</title>

		<meta name="description" content="public BufferedImage createVerifyCode() { int width = 80; int height = 32; // 创建图片  BufferedImage image = new BufferedImage(width, height, BufferedImage.TYPE_INT_RGB); Graphics g = image.getGraphics(); // 设置背景颜色  g.setColor(new Color(0xDCDCDC)); g.fillRect(0, 0, width, height); // 边框  g.setColor(Color.BLACK); g.drawRect(0, 0, width - 1, height - 1); // 生成随机数  Random rdm = new Random(); // 生成50个点  for (int i = 0; i &lt; 50; i&#43;&#43;) { int x = rdm.">


		
		<link rel="shortcut icon" href="/images/logo.png">
		
	
		




<link rel="stylesheet" href="/css/ui.css">

	
		

		<link  rel="stylesheet" href="https://fonts.googleapis.com/css?family=Fira+Mono|Lato|Raleway">

		
		<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/atelier-savanna-light.min.css">
		<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
		
		<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.4.0/languages/common.min.js"></script>
		
		
	</head>

<body>
<header class="container no-print">
	<div class="u-header">
		<nav class="bar">
	<ul><li>
			<a href="/">
				<img class="icon-text" src="/img/prev.svg"/>
			</a>
		</li><li><a href="/about/">了解我</a></li><li><a href="/blog/">博客</a></li><li><a href="/work/">工作</a></li></ul>
</nav>

	</div>
</header>
<main class="container">

<article>
	<header><hgroup id="brand">
	<h1>Java生成图片验证码</h1>
	<h5>
		
		<time datetime="2018-04-22 15:49:23 &#43;0800 CST">2018年 4月 22日</time>
		<span class="no-print">
			-
				
				<a href="/tags/java">java</a>
				<span>
	</h5>
	
</hgroup>
<hr class="sep" />
</header>
	<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-Java" data-lang="Java"><span style="color:#66d9ef">public</span> BufferedImage <span style="color:#a6e22e">createVerifyCode</span><span style="color:#f92672">()</span> <span style="color:#f92672">{</span>

    <span style="color:#66d9ef">int</span> width <span style="color:#f92672">=</span> 80<span style="color:#f92672">;</span>
    <span style="color:#66d9ef">int</span> height <span style="color:#f92672">=</span> 32<span style="color:#f92672">;</span>
    <span style="color:#75715e">// 创建图片
</span><span style="color:#75715e"></span>    BufferedImage image <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> BufferedImage<span style="color:#f92672">(</span>width<span style="color:#f92672">,</span> height<span style="color:#f92672">,</span> BufferedImage<span style="color:#f92672">.</span><span style="color:#a6e22e">TYPE_INT_RGB</span><span style="color:#f92672">);</span>
    Graphics g <span style="color:#f92672">=</span> image<span style="color:#f92672">.</span><span style="color:#a6e22e">getGraphics</span><span style="color:#f92672">();</span>
    <span style="color:#75715e">// 设置背景颜色
</span><span style="color:#75715e"></span>    g<span style="color:#f92672">.</span><span style="color:#a6e22e">setColor</span><span style="color:#f92672">(</span><span style="color:#66d9ef">new</span> Color<span style="color:#f92672">(</span>0xDCDCDC<span style="color:#f92672">));</span>
    g<span style="color:#f92672">.</span><span style="color:#a6e22e">fillRect</span><span style="color:#f92672">(</span>0<span style="color:#f92672">,</span> 0<span style="color:#f92672">,</span> width<span style="color:#f92672">,</span> height<span style="color:#f92672">);</span>
    <span style="color:#75715e">// 边框
</span><span style="color:#75715e"></span>    g<span style="color:#f92672">.</span><span style="color:#a6e22e">setColor</span><span style="color:#f92672">(</span>Color<span style="color:#f92672">.</span><span style="color:#a6e22e">BLACK</span><span style="color:#f92672">);</span>
    g<span style="color:#f92672">.</span><span style="color:#a6e22e">drawRect</span><span style="color:#f92672">(</span>0<span style="color:#f92672">,</span> 0<span style="color:#f92672">,</span> width <span style="color:#f92672">-</span> 1<span style="color:#f92672">,</span> height <span style="color:#f92672">-</span> 1<span style="color:#f92672">);</span>
    <span style="color:#75715e">// 生成随机数
</span><span style="color:#75715e"></span>    Random rdm <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Random<span style="color:#f92672">();</span>
    <span style="color:#75715e">// 生成50个点
</span><span style="color:#75715e"></span>    <span style="color:#66d9ef">for</span> <span style="color:#f92672">(</span><span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> 0<span style="color:#f92672">;</span> i <span style="color:#f92672">&lt;</span> 50<span style="color:#f92672">;</span> i<span style="color:#f92672">++)</span> <span style="color:#f92672">{</span>
        <span style="color:#66d9ef">int</span> x <span style="color:#f92672">=</span> rdm<span style="color:#f92672">.</span><span style="color:#a6e22e">nextInt</span><span style="color:#f92672">(</span>width<span style="color:#f92672">);</span>
        <span style="color:#66d9ef">int</span> y <span style="color:#f92672">=</span> rdm<span style="color:#f92672">.</span><span style="color:#a6e22e">nextInt</span><span style="color:#f92672">(</span>height<span style="color:#f92672">);</span>
        g<span style="color:#f92672">.</span><span style="color:#a6e22e">drawOval</span><span style="color:#f92672">(</span>x<span style="color:#f92672">,</span> y<span style="color:#f92672">,</span> 0<span style="color:#f92672">,</span> 0<span style="color:#f92672">);</span>
    <span style="color:#f92672">}</span>
    <span style="color:#75715e">// 生成验证码
</span><span style="color:#75715e"></span>    String verifyCode <span style="color:#f92672">=</span> generateVerifyCode<span style="color:#f92672">(</span>rdm<span style="color:#f92672">);</span>
    g<span style="color:#f92672">.</span><span style="color:#a6e22e">setColor</span><span style="color:#f92672">(</span><span style="color:#66d9ef">new</span> Color<span style="color:#f92672">(</span>0<span style="color:#f92672">,</span> 100<span style="color:#f92672">,</span> 0<span style="color:#f92672">));</span>
    g<span style="color:#f92672">.</span><span style="color:#a6e22e">setFont</span><span style="color:#f92672">(</span><span style="color:#66d9ef">new</span> Font<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;Candara&#34;</span><span style="color:#f92672">,</span> Font<span style="color:#f92672">.</span><span style="color:#a6e22e">BOLD</span><span style="color:#f92672">,</span> 24<span style="color:#f92672">));</span>
    g<span style="color:#f92672">.</span><span style="color:#a6e22e">drawString</span><span style="color:#f92672">(</span>verifyCode<span style="color:#f92672">,</span> 8<span style="color:#f92672">,</span> 24<span style="color:#f92672">);</span>
    g<span style="color:#f92672">.</span><span style="color:#a6e22e">dispose</span><span style="color:#f92672">();</span>
    <span style="color:#75715e">// 把验证码存到redis中
</span><span style="color:#75715e"></span>    <span style="color:#66d9ef">int</span> rnd <span style="color:#f92672">=</span> calc<span style="color:#f92672">(</span>verifyCode<span style="color:#f92672">);</span>
    <span style="color:#66d9ef">return</span> image<span style="color:#f92672">;</span>
<span style="color:#f92672">}</span>

<span style="color:#75715e">/**
</span><span style="color:#75715e"> * 计算得数
</span><span style="color:#75715e">*/</span>
<span style="color:#66d9ef">private</span> <span style="color:#66d9ef">int</span> <span style="color:#a6e22e">calc</span><span style="color:#f92672">(</span>String exp<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
    <span style="color:#66d9ef">try</span> <span style="color:#f92672">{</span>
        ScriptEngineManager manager <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> ScriptEngineManager<span style="color:#f92672">();</span>
        ScriptEngine engine <span style="color:#f92672">=</span> manager<span style="color:#f92672">.</span><span style="color:#a6e22e">getEngineByName</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;JavaScript&#34;</span><span style="color:#f92672">);</span>
        <span style="color:#66d9ef">return</span> <span style="color:#f92672">(</span><span style="color:#66d9ef">int</span><span style="color:#f92672">)</span> engine<span style="color:#f92672">.</span><span style="color:#a6e22e">eval</span><span style="color:#f92672">(</span>exp<span style="color:#f92672">);</span>
    <span style="color:#f92672">}</span> <span style="color:#66d9ef">catch</span> <span style="color:#f92672">(</span>Exception e<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
        e<span style="color:#f92672">.</span><span style="color:#a6e22e">printStackTrace</span><span style="color:#f92672">();</span>
        <span style="color:#66d9ef">return</span> 0<span style="color:#f92672">;</span>
    <span style="color:#f92672">}</span>
<span style="color:#f92672">}</span>

<span style="color:#66d9ef">private</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">char</span><span style="color:#f92672">[]</span> ops <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#66d9ef">char</span><span style="color:#f92672">[]{</span><span style="color:#e6db74">&#39;+&#39;</span><span style="color:#f92672">,</span> <span style="color:#e6db74">&#39;-&#39;</span><span style="color:#f92672">,</span> <span style="color:#e6db74">&#39;*&#39;</span><span style="color:#f92672">};</span>

<span style="color:#75715e">/**
</span><span style="color:#75715e"> * 随机进行+ - *
</span><span style="color:#75715e">*/</span>
<span style="color:#66d9ef">private</span> String <span style="color:#a6e22e">generateVerifyCode</span><span style="color:#f92672">(</span>Random rdm<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
    <span style="color:#66d9ef">int</span> num1 <span style="color:#f92672">=</span> rdm<span style="color:#f92672">.</span><span style="color:#a6e22e">nextInt</span><span style="color:#f92672">(</span>10<span style="color:#f92672">);</span>
    <span style="color:#66d9ef">int</span> num2 <span style="color:#f92672">=</span> rdm<span style="color:#f92672">.</span><span style="color:#a6e22e">nextInt</span><span style="color:#f92672">(</span>10<span style="color:#f92672">);</span>
    <span style="color:#66d9ef">int</span> num3 <span style="color:#f92672">=</span> rdm<span style="color:#f92672">.</span><span style="color:#a6e22e">nextInt</span><span style="color:#f92672">(</span>10<span style="color:#f92672">);</span>
    <span style="color:#66d9ef">char</span> op1 <span style="color:#f92672">=</span> ops<span style="color:#f92672">[</span>rdm<span style="color:#f92672">.</span><span style="color:#a6e22e">nextInt</span><span style="color:#f92672">(</span>3<span style="color:#f92672">)];</span>
    <span style="color:#66d9ef">char</span> op2 <span style="color:#f92672">=</span> ops<span style="color:#f92672">[</span>rdm<span style="color:#f92672">.</span><span style="color:#a6e22e">nextInt</span><span style="color:#f92672">(</span>3<span style="color:#f92672">)];</span>
    String exp <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;&#34;</span> <span style="color:#f92672">+</span> num1 <span style="color:#f92672">+</span> op1 <span style="color:#f92672">+</span> num2 <span style="color:#f92672">+</span> op2 <span style="color:#f92672">+</span> num3<span style="color:#f92672">;</span>
    <span style="color:#66d9ef">return</span> exp<span style="color:#f92672">;</span>
<span style="color:#f92672">}</span>
</code></pre></div>
</article>
<nav class="no-print post-nav">

	<a class="prev-post" href="https://xumf.github.io/blog/redis%E5%88%86%E5%B8%83%E5%BC%8F%E9%94%81/">
		<img class="icon-text" src="/img/prev.svg"/>Redis分布式锁</a>


	<a class="next-post" href="https://xumf.github.io/blog/centos-download-rabbitmq/">Centos Download Rabbitmq<img class="icon-text" src="/img/next.svg"/>
	</a>

</nav>





	<div id="disqus_thread" class="no-print"></div>
<script type="text/javascript">

(function() {
    
    
    if (window.location.hostname == "localhost")
        return;

    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    var disqus_shortname = 'xumf';
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>


			<hr class="sep" />
		</main>
		<footer class="container no-print">
			<div class="u-footer">
				
<a href="mailto:mail@xumf.net"><img class="icon-social" src="/img/email.svg" alt="Email Me!"/></a>


<a href="https://github.com/xumf/"><img class="icon-social" src="/img/github.svg" alt="Github"/></a>


<a href="https://xumf.github.io/index.xml" target="_blank"><img class="icon-social" src="/img/feed.svg" alt="Feed"></a>


				<p>
					
					
					&copy; 2018  xumf.net</a>
					
					
					| <a href="/about/license"></a>
					
				</p>
				
				<a href="#brand">
					<img class="icon-text" src="/img/toup.svg" alt="To Up"/>
					<span></span>
				</a>
				
			</div>
		</footer>
		
		<script>hljs.initHighlightingOnLoad();</script>
		
	</body>
</html>

